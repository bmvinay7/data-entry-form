# ðŸ¤– Complete Zapier Agent Prompt - Data Entry Form to Google Sheets

## OBJECTIVE
Create a Zapier automation that receives form data from a webhook and saves it to a Google Spreadsheet with proper formatting and data validation.

## STEP 1: CREATE THE TRIGGER (Webhooks by Zapier)

### Trigger Configuration:
- **App**: Webhooks by Zapier
- **Event**: Catch Hook
- **Webhook URL**: Use the provided webhook URL (will be generated by Zapier)

### Expected Data Format:
The webhook will receive JSON data with these exact field names:
```json
{
  "fullName": "John Smith",
  "email": "john.smith@example.com", 
  "phone": "+44 7700 900123",
  "streetAddress": "123 Main Street",
  "city": "London",
  "postcode": "SW1A 1AA",
  "comments": "Optional comments from the user",
  "timestamp": "2024-12-28T10:30:45.123Z"
}
```

### Test Data for Setup:
Use this sample data to test the webhook trigger:
```json
{
  "fullName": "Test User",
  "email": "testuser@example.com",
  "phone": "+44 7700 900456",
  "streetAddress": "456 Test Avenue", 
  "city": "Manchester",
  "postcode": "M1 1AA",
  "comments": "This is a test submission from the form",
  "timestamp": "2024-12-28T12:00:00.000Z"
}
```

## STEP 2: CREATE THE ACTION (Google Sheets)

### Action Configuration:
- **App**: Google Sheets
- **Event**: Create Spreadsheet Row
- **Account**: Connect your Google account that has access to the target spreadsheet

### Spreadsheet Details:
- **Spreadsheet**: Select existing spreadsheet with ID: `1mmDRze-8_-bdztvkVqpum6vxGPVkmYFbosIbp4mFdKo`
- **Worksheet**: Use the first worksheet (usually "Sheet1")

### Column Mapping (CRITICAL - Map exactly as shown):

| Column A | Column B | Column C | Column D | Column E | Column F | Column G | Column H |
|----------|----------|----------|----------|----------|----------|----------|----------|
| **Header** | Full Name | Email Address | Phone Number | Street Address | City | Postcode | Comments | Timestamp |
| **Zapier Field** | {{fullName}} | {{email}} | {{phone}} | {{streetAddress}} | {{city}} | {{postcode}} | {{comments}} | {{timestamp}} |

### Detailed Field Mapping:
1. **Column A (Full Name)**: Map to `fullName` from webhook data
2. **Column B (Email Address)**: Map to `email` from webhook data  
3. **Column C (Phone Number)**: Map to `phone` from webhook data
4. **Column D (Street Address)**: Map to `streetAddress` from webhook data
5. **Column E (City)**: Map to `city` from webhook data
6. **Column F (Postcode)**: Map to `postcode` from webhook data
7. **Column G (Comments)**: Map to `comments` from webhook data
8. **Column H (Timestamp)**: Map to `timestamp` from webhook data

## STEP 3: ADVANCED CONFIGURATION

### Data Formatting Rules:
- **Full Name**: Keep as received, no transformation needed
- **Email**: Convert to lowercase for consistency
- **Phone**: Keep as received (may include international format)
- **Street Address**: Keep as received, preserve capitalization
- **City**: Capitalize first letter of each word
- **Postcode**: Convert to uppercase
- **Comments**: Keep as received, preserve line breaks if any
- **Timestamp**: Format as readable date/time (e.g., "Dec 28, 2024 12:00 PM")

### Error Handling:
- If any required field is missing, still create the row but mark it clearly
- Add error handling for duplicate emails (optional)
- Ensure the Zap continues running even if one submission fails

## STEP 4: TESTING REQUIREMENTS

### Test Scenarios:
1. **Complete Data Test**: Submit with all fields filled
2. **Minimal Data Test**: Submit with only required fields (fullName, email, streetAddress, city, postcode)
3. **Special Characters Test**: Submit with special characters in name and address
4. **International Phone Test**: Submit with international phone format
5. **Long Comments Test**: Submit with lengthy comments text

### Expected Results:
- Each test should create a new row in the spreadsheet
- Data should appear in correct columns
- Formatting should be applied as specified
- No data should be truncated or corrupted

## STEP 5: WEBHOOK URL CONFIGURATION

### After Zap Creation:
1. Copy the webhook URL provided by Zapier
2. The URL format should be: `https://hooks.zapier.com/hooks/catch/[USER_ID]/[HOOK_ID]/`
3. Provide this URL for integration with the web form

### Security Considerations:
- The webhook should accept POST requests only
- JSON content type should be supported
- No authentication required (public webhook)
- Rate limiting should be reasonable for form submissions

## STEP 6: FINAL VALIDATION

### Checklist Before Activation:
- [ ] Webhook trigger is properly configured
- [ ] Google Sheets action connects to correct spreadsheet
- [ ] All 8 columns are mapped correctly
- [ ] Test data flows through successfully
- [ ] Formatting rules are applied
- [ ] Error handling is in place
- [ ] Zap is turned ON and active

### Success Criteria:
- Form submissions appear in Google Sheets within 30 seconds
- Data is properly formatted and organized
- No data loss or corruption occurs
- Zap runs reliably without manual intervention

## TROUBLESHOOTING GUIDE

### Common Issues and Solutions:

**Issue**: Webhook not receiving data
- **Solution**: Verify the webhook URL is correctly configured in the web form

**Issue**: Data appearing in wrong columns  
- **Solution**: Check field mapping in Google Sheets action

**Issue**: Timestamp not formatting correctly
- **Solution**: Use Zapier's date/time formatter to convert ISO timestamp

**Issue**: Special characters not displaying properly
- **Solution**: Ensure UTF-8 encoding is maintained throughout the process

**Issue**: Zap stops working after some time
- **Solution**: Check for API limits, authentication issues, or spreadsheet permissions

## EXPECTED FINAL RESULT

When working correctly, the Zap should:
1. Receive form data via webhook instantly
2. Process and format the data appropriately  
3. Add a new row to the Google Spreadsheet
4. Maintain data integrity and formatting
5. Handle errors gracefully without stopping
6. Provide reliable service for ongoing form submissions

## WEBHOOK URL TO PROVIDE
After successful Zap creation, provide the webhook URL in this format:
`https://hooks.zapier.com/hooks/catch/[YOUR_USER_ID]/[YOUR_HOOK_ID]/`

This URL will be integrated into the web form for seamless data submission.